from flask import Flask, request, jsonify, redirect, render_template_string

app = Flask(__name__)

# The index.html content is embedded directly in the Python file using render_template_string
@app.route('/')
def index():
    return render_template_string('''
    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Generate Video</title>
    </head>
    <body>
        <h1>Video Generator</h1>
        <form id="video-form">
            <label for="script">Script:</label><br>
            <textarea id="script" rows="4" cols="50"></textarea><br><br>

            <label for="additional-prompts">Prompts:</label><br>
            <textarea id="additional-prompts" rows="4" cols="50"></textarea><br><br>

            <label for="video-length">Video Length:</label>
            <input type="text" id="video-length" name="video-length"><br><br>

            <label for="video-style">Video Style:</label>
            <input type="text" id="video-style" name="video-style"><br><br>

            <button id="generate-video" onclick="handleSubmit(event)">Generate Video</button>
        </form>

        <script>
            function handleSubmit(event) {
                event.preventDefault();

                const script = document.getElementById('script').value;
                const prompts = document.getElementById('additional-prompts').value;
                const videoLength = document.getElementById('video-length').value;
                const videoStyle = document.getElementById('video-style').value;

                // Send request to backend
                fetch('/generate-video', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        script: script,
                        prompts: prompts,
                        videoLength: videoLength,
                        videoStyle: videoStyle
                    }),
                })
                .then(response => response.json())
                .then(data => {
                    if (data.redirect) {
                        window.location.href = data.redirect;  // Redirects to 2.py automatically
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                });
            }
        </script>
    </body>
    </html>
    ''')

# Backend route for handling form submission
@app.route('/generate-video', methods=['POST'])
def generate_video():
    data = request.json
    script = data.get('script')
    prompts = data.get('prompts')
    video_length = data.get('videoLength')
    video_style = data.get('videoStyle')

    # Process the form data here if needed (e.g., generate a video)

    # Redirect to 2.py after processing
    return jsonify({'redirect': '/2.py'})

# The 2.py route simulates another processing file
@app.route('/2.py')
def second_file():
    # Simulate the output of 2.py
    return "Video generated! This is the 2.py page with video details."

if __name__ == "__main__":
    app.run(debug=True)         
